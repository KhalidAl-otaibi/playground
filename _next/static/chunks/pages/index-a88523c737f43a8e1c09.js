(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4612:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return p}});var r=t(6952),o=t(8742),i=t.n(o),u=t(2547),a=t(6695),s=t(8617),c=t(7378),l=t(4246),d=t(7061),f=(0,s.default)((function(){return Promise.all([t.e(90),t.e(329)]).then(t.bind(t,2329))}),{ssr:!1,loadableGenerated:{webpack:function(){return[2329]},modules:["index.tsx -> react-ace"]}}),h=function(){var n=(0,a.useGoogleLogin)(),e=n.isSignedIn,t=n.auth;return n.ready?(0,l.jsx)("button",{onClick:function(){return e?null===t||void 0===t?void 0:t.signOut():null===t||void 0===t?void 0:t.signIn()},children:e?"Signout":"Signin"}):null},v=function(){var n=(0,c.useState)(""),e=n[0],t=n[1],o=(0,c.useState)("python"),a=o[0],s=o[1],d=(0,c.useState)(),h=d[0],v=d[1],p=(0,u.usePlayground)(),g=p.run,m=p.load,y=(0,c.useRef)(),b=(0,c.useState)(!1),x=b[0],P=b[1];(0,c.useEffect)((function(){m("cs124/playground-python").then((function(){m("cs124/playground-cpp")}))}),[m]);var _=(0,c.useCallback)((0,r.Z)(i().mark((function n(){var e,t,r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(y.current){n.next=2;break}return n.abrupt("return");case 2:if(""!==(e=y.current.getValue()).trim()){n.next=6;break}return v(void 0),n.abrupt("return");case 6:return t={image:"python"===a?"cs124/playground-python":"cs124/playground-cpp",filesystem:"python"===a?[{path:"main.py",contents:e}]:[{path:"main.cpp",contents:e}]},n.prev=7,P(!0),n.next=11,g(t,!0);case 11:(r=n.sent).timedOut?v({error:"Timeout"}):v({result:r}),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(7),v({error:n.t0.toString()});case 18:return n.prev=18,P(!1),n.finish(18);case 21:case"end":return n.stop()}}),n,null,[[7,15,18,21]])}))),[a,g]),j=(0,c.useMemo)((function(){var n;return(null===h||void 0===h?void 0:h.error)||(null===h||void 0===h||null===(n=h.result)||void 0===n?void 0:n.outputLines.map((function(n){return n.line})).join("\n"))||""}),[h]),C=(0,c.useMemo)((function(){return[{name:"gotoline",exec:function(){return!1},bindKey:{win:"",mac:""}},{name:"run",bindKey:{win:"Ctrl-Enter",mac:"Ctrl-Enter"},exec:function(){return _()},readOnly:!0},{name:"close",bindKey:{win:"Esc",mac:"Esc"},exec:function(){return v(void 0)},readOnly:!0}]}),[_]);return(0,c.useEffect)((function(){C.forEach((function(n){var e;y.current&&(null===(e=y.current)||void 0===e||e.commands.addCommand(n))}))}),[C]),(0,c.useEffect)((function(){t("python"===a?'print("Hello, Python!")':'\n#include <iostream>\nint main() {\n    std::cout << "Hello, CPP!\\n";\n    return 0;\n}'),v(void 0)}),[a]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f,{mode:a,theme:"github",width:"100%",height:"16rem",minLines:16,maxLines:1/0,value:e,showPrintMargin:!1,onBeforeLoad:function(n){n.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@".concat(n.version,"/src-min-noconflict"))},onLoad:function(n){y.current=n},onChange:t,commands:C,setOptions:{tabSize:2}}),(0,l.jsxs)("div",{style:{marginTop:8},children:[(0,l.jsx)("button",{onClick:function(){_()},style:{marginRight:8},children:"Run"}),(0,l.jsx)("div",{style:{float:"right"},children:(0,l.jsx)("button",{onClick:function(){return s("python"===a?"cpp":"python")},children:"cpp"===a?"Python":"CPP"})})]}),(0,l.jsx)("div",{className:"output",children:x?(0,l.jsx)("span",{children:"Running..."}):void 0!==j?(0,l.jsx)("span",{children:j}):(0,l.jsx)("span",{})}),(null===h||void 0===h?void 0:h.result)&&(0,l.jsx)(f,{readOnly:!0,theme:"github",mode:"json",height:"32rem",value:JSON.stringify(h.result,null,2)})]})};function p(){return(0,l.jsx)(a.GoogleLoginProvider,{clientConfig:{client_id:d.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID},children:(0,l.jsx)(a.WithGoogleTokens,{children:function(n){var e=n.idToken;return(0,l.jsxs)(u.PlaygroundProvider,{googleToken:e,server:d.env.NEXT_PUBLIC_PLAYGROUND_SERVER,children:[(0,l.jsx)("h2",{children:"Playground Demo"}),(0,l.jsx)("div",{style:{marginBottom:8},children:(0,l.jsx)(h,{})}),(0,l.jsx)(v,{})]})}})})}},4423:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4612)}])},2547:function(n,e,t){var r=this&&this.__createBinding||(Object.create?function(n,e,t,r){void 0===r&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){void 0===r&&(r=t),n[r]=e[t]}),o=this&&this.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),i=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&r(e,n,t);return o(e,n),e},u=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(o,i){function u(n){try{s(r.next(n))}catch(e){i(e)}}function a(n){try{s(r.throw(n))}catch(e){i(e)}}function s(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(u,a)}s((r=r.apply(n,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PlaygroundContext=e.usePlayground=e.PlaygroundProvider=void 0;const a=t(8741),s=i(t(7378));e.PlaygroundProvider=({googleToken:n,server:t,children:r})=>{const[o,i]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{fetch(t).then((n=>n.json())).then((n=>i(n.status))).catch((()=>i(void 0)))}),[t]);const c=(0,s.useCallback)(((e,r=!1)=>u(this,void 0,void 0,(function*(){e=r?a.Submission.check(e):e;const o=yield fetch(t,{method:"post",body:JSON.stringify(e),headers:Object.assign({"Content-Type":"application/json"},n&&{"google-token":n})}).then((n=>u(this,void 0,void 0,(function*(){if(200===n.status){const e=yield n.json();return i(e.status),e}throw yield n.text()})))).catch((n=>{throw i(void 0),n}));return r?a.Result.check(o):o}))),[n,t]),l=(0,s.useCallback)((n=>u(this,void 0,void 0,(function*(){yield fetch(`${t}/image/${n}`)}))),[t]);return s.default.createElement(e.PlaygroundContext.Provider,{value:{available:!0,status:o,connected:void 0!==o,run:c,load:l}},r)};e.usePlayground=()=>(0,s.useContext)(e.PlaygroundContext),e.PlaygroundContext=s.default.createContext({available:!1,connected:!1,status:void 0,run:()=>{throw new Error("Playground context not available")},load:()=>{throw new Error("Playground context not available")}})},8741:function(n,e,t){Object.defineProperty(e,"__esModule",{value:!0}),e.Status=e.Result=e.Submission=e.FakeFile=e.OutputLine=e.Console=void 0;const r=t(4690);e.Console=(0,r.Union)((0,r.Literal)("STDOUT"),(0,r.Literal)("STDERR")),e.OutputLine=(0,r.Record)({console:e.Console,timestamp:r.String.withConstraint((n=>!isNaN(Date.parse(n)))),line:r.String}),e.FakeFile=(0,r.Record)({path:r.String,contents:r.String}),e.Submission=(0,r.Record)({image:r.String}).And((0,r.Partial)({filesystem:(0,r.Array)(e.FakeFile),timeout:r.Number})),e.Result=(0,r.Record)({started:r.String.withConstraint((n=>!isNaN(Date.parse(n)))),ended:r.String.withConstraint((n=>!isNaN(Date.parse(n)))),outputLines:(0,r.Array)(e.OutputLine),timedOut:r.Boolean,exitValue:r.Number}),e.Status=(0,r.Record)({started:r.String.withConstraint((n=>!isNaN(Date.parse(n)))),version:r.String})}},function(n){n.O(0,[774,799,888,179],(function(){return e=4423,n(n.s=e);var e}));var e=n.O();_N_E=e}]);